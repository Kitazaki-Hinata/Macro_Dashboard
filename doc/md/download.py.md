<!-- Auto-generated API docs. Do not edit by hand. -->
# download.py

- Source: `download.py`
- Generated by `tools/generate_md_docs.py`

---
## Module doc

_No docstring._

## Functions

### _exponential_backoff_delays(max_attempts, base, factor, jitter)

Generate delays for exponential backoff with jitter.
### http_get_with_retry(url, *, params, headers, timeout, max_attempts)

_No docstring._
### http_post_with_retry(url, *, data, json_data, headers, timeout, max_attempts, delay_seconds)

_No docstring._
### yf_download_with_retry(symbol, *, start, end, interval, max_attempts)

Wrapper around yfinance.download with exponential backoff.

- Explicitly sets auto_adjust=False to avoid FutureWarning noise and preserves raw OHLCV.
- Sets threads=False to reduce internal concurrency (we already manage external concurrency).
- Retries on YFRateLimitError or empty DataFrame results.

## Classes

### class DatabaseConverter

_No docstring._
#### DatabaseConverter.__init__(self, db_file)

_No docstring._
#### DatabaseConverter._convert_month_str_to_num(month_str)

_No docstring._
#### DatabaseConverter._rename_bea_date_col(df)

modify time index, unify all time index in different dataframe(time series dataframe
#### DatabaseConverter._format_converter(df, data_name, is_pct_data)

将不同来源的数据统一为两列: date(YYYY-MM-DD) + value 列名为 data_name。
足够健壮地应对 None/Timestamp/int 等类型，并容忍短表、重复、缺失。
#### DatabaseConverter._create_ts_sheet(self, start_date)

If time_series_table does not exist, then create new db
如果sheet不存在，创建sheet
#### DatabaseConverter.write_into_db(self, df, data_name, start_date, is_time_series, is_pct_data)

params df: df that used to write into db
params data_name: used in db columns and errors
params start_date, start date of  all data, used when create db sheet
params is_time_series: judge whether it is time series data, incl. BEA, BLS, YF, TE, FRED
params is_pct_data: input json data, bool value, "needs_pct"
### class DataDownloader

_No docstring._
#### DataDownloader.to_db(self, return_csv, max_workers)

Download data and either write to DB or return DataFrames per table.
If return_df=True, return a dict mapping table_name -> DataFrame; otherwise None.
max_workers: Optional[int] for concurrent downloads (None => sensible default).
### class BEADownloader

_No docstring._
#### BEADownloader.__init__(self, json_dict, api_key, request_year)

_No docstring._
#### BEADownloader.to_db(self, return_csv, max_workers)

_No docstring._
### class YFDownloader

_No docstring._
#### YFDownloader.__init__(self, json_dict, api_key, request_year)

_No docstring._
#### YFDownloader.to_db(self, return_csv, max_workers)

_No docstring._
### class FREDDownloader

_No docstring._
#### FREDDownloader.__init__(self, json_dict, api_key, request_year)

_No docstring._
#### FREDDownloader.to_db(self, return_csv, max_workers)

_No docstring._
### class BLSDownloader

_No docstring._
#### BLSDownloader.__init__(self, json_dict, api_key, request_year)

_No docstring._
#### BLSDownloader.to_db(self, return_csv, debug, max_workers)

_No docstring._
### class TEDownloader

_No docstring._
#### TEDownloader._build_chrome_options(headless)

_No docstring._
#### TEDownloader.__init__(self, json_dict, api_key, request_year, *, headless)

_No docstring._
#### TEDownloader._cache_path(self, data_name)

_No docstring._
#### TEDownloader._cache_read(self, data_name)

_No docstring._
#### TEDownloader._cache_write(self, data_name, df)

_No docstring._
#### TEDownloader._get_config_by_name(self, data_name)

_No docstring._
#### TEDownloader._resolve_locators(self, kind, data_name, defaults)

_No docstring._
#### TEDownloader._calc_function(self, x1, x2, y1, y2)

解二元一次方程，用于计算数据 used for data calculation
#### TEDownloader._get_data_from_trading_economics_month(self, data_name)

提取月度数据的代码，季度数据需要单独写
主要流程：访问页面，点击5y按钮，点击bar按钮，提取table数字，提取bar长度，反向计算数据
#### TEDownloader._dismiss_te_popups(self, data_name)

Best-effort: close cookie/terms banners or overlays to avoid click intercepts.
#### TEDownloader._click_5y(self, data_name)

Click the 5Y range button using multiple locators and a retry once.
#### TEDownloader.to_db(self, return_csv, max_workers)

_No docstring._
### class DownloaderFactory

API/Interface, factory that direct to different data-instance classes
#### DownloaderFactory._get_api_key(cls, source)

获取api key，从env文件获得
#### DownloaderFactory.create_downloader(cls, source, json_data, request_year)

_No docstring._
